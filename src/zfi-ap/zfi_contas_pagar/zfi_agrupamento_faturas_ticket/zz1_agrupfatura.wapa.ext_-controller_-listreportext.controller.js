sap.ui.define(["sap/ui/export/Spreadsheet","sap/ui/core/util/Export","sap/ui/export/library","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox"],function(e,a,s,r,t,o,i){"use strict";var n=s.EdmType;return sap.ui.controller("br.com.tres+
coracoes.cockpitagrupafaturas.ext.controller.ListReportExt",{onOpenLog:function(e){var a=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal({target:{semanticObject:"logagrupafaturas",action:"di+
splay"}});sap.m.URLHelper.redirect(a,true)},onOpenParamForn:function(e){var a=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal({target:{semanticObject:"cadfornecedoragrupador",action:"maintai+
n"}});sap.m.URLHelper.redirect(a,true)},onUploadExcel:function(e){var a=new sap.m.Dialog({contentWidth:"300px",resizable:true,type:"Message"});a.setTitle("Carregar arquivo Excel");var s="/sap/opu/odata/SAP/ZFI_AGRUPA_FATURA_SRV/";var r=new sap.ui.model.o+
data.ODataModel(s,false);var t=s+"ExcelSet";var o=new sap.ui.unified.FileUploader({width:"100%",fileType:"xlsx",style:"Emphasized",uploadComplete:function(e){var s=this.oView.sId+"--responsiveTable";var r=this.byId(s);r.getModel().refresh(true);a.close()+
;a.destroy();if(e.mParameters.status=="200"||e.mParameters.status=="201"){sap.m.MessageToast.show("Carga realizada com sucesso.")}else{let a=[];for(const s of e.mParameters.responseRaw.matchAll(/(?:<message>(.*?)<[/]message>)/gm)){a.push(s[1])}let s=[];f+
or(const a of e.mParameters.responseRaw.matchAll(/(?:<severity>(.*?)<[/]severity>)/gm)){switch(a[1]){case"error":s.push(sap.ui.core.MessageType.Error);break;case"info":s.push(sap.ui.core.MessageType.Information);break;case"success":s.push(sap.ui.core.Mes+
sageType.Success);break;case"warning":s.push(sap.ui.core.MessageType.Warning);break;default:s.push(sap.ui.core.MessageType.None);break}}for(let e=0;e<a.length;e++){if(a[e]=="Ocorreu uma exceção"){continue}sap.ui.getCore().getMessageManager().addMessages(+
new sap.ui.core.message.Message({message:a[e],persistent:true,type:s[e]}));alert(a[e])}}}.bind(this)});o.setName("Simple Uploader");o.setUploadUrl(t);o.setSendXHR(true);o.setUseMultipart(false);o.setUploadOnChange(false);var i=new sap.ui.unified.FileUplo+
aderParameter({name:"x-csrf-token",value:r.getSecurityToken()});o.insertHeaderParameter(i);var n=new sap.m.Button({text:"Upload",type:"Accept",press:function(){var e=o.getFocusDomRef();var a=e.files[0];if(o.getValue()===""){sap.m.MessageToast.show("Favor+
 selecionar um arquivo");return}var s=new sap.ui.unified.FileUploaderParameter({name:"Content-Type",value:a.type});o.insertHeaderParameter(s);o.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:o.getValue()}));o.upload()}.+
bind(this)});var p=new sap.m.Button({text:"Cancelar",type:"Reject",press:function(){a.close();a.destroy();this.getView().removeAllDependents()}.bind(this)});a.addContent(o);a.setBeginButton(p);a.setEndButton(n);a.open()}})});                              