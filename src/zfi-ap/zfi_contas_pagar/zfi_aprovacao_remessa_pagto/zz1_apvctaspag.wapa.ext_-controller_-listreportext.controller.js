sap.ui.define([],function(){"use strict";return{oMsgDialog:undefined,aMessages:new Array,sleep:function(e){const t=Date.now();let n=null;do{n=Date.now()}while(n-t<e)},onApprove:async function(e){let t=this.templateBaseExtension.getExtensionAPI();this._ap+
provePayment(t)},fetchMessage:function(e){if(e.dwdat!=undefined||e.dwdat!=null){this.aMessages.push({type:sap.ui.core.MessageType.Warning,title:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("DwDateSub").replace("&1",e.dwdat.toLoca+
leDateString()).replace("&2",e.dwusr),description:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("DwDateTitle"),subtitle:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("DwDateDesc")})}if(e.NivelAtual=="1"){th+
is.aMessages.push({type:sap.ui.core.MessageType.Success,title:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("ActionMessage"),description:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("ActionTitle"),subtitle+
:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("ActionSubEnc").replace("&1",e.CashPlanningGroup).replace("&2",e.NivelAtual).replace("&3",e.Username)})}if(e.NivelAtual!="1"){var t=parseInt(e.NivelAtual);t=t-1;this.aMessages.push({t+
ype:sap.ui.core.MessageType.Success,title:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("ActionMessage"),description:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("ActionTitle"),subtitle:this.getOwnerCompon+
ent().getModel("i18n").getResourceBundle().getText("ActionSub").replace("&1",e.CashPlanningGroup).replace("&2",t).replace("&3",e.Username)})}},_approvePayment:function(e){let t=[];for(let n of e.getSelectedContexts()){let e=n.getObject();t.push(new Promi+
se(function(t,n){this.getView().getModel().callFunction("/approv",{method:"POST",urlParameters:{CompanyCode:e.CompanyCode,NetDueDate:e.NetDueDate.toISOString().slice(0,10).split("-").join(""),RunHourTo:e.RunHourTo.toLocaleString(),RepType:e.RepType,CashP+
lanningGroup:e.CashPlanningGroup},success:function(n,o){this.getView().getModel().read("/ContasPagar('"+encodeURIComponent(e.ID)+"')",{success:function(e,n){t(e)}})}.bind(this),error:function(e){n(e)}})}.bind(this)))}for(let n of t){e.securedExecution(n.+
then(this.fetchMessage.bind(this)).then(e.refreshTable()).finally(this.showMessages.bind(this)).catch(function(e){sap.m.MessageToast.show(e)}),{busy:{set:true,check:true}})}},showMessages:function(){let e=new sap.m.MessageView({showDetailsPageHeader:true+
,items:{path:"/",template:new sap.m.MessageItem({type:"{type}",title:"{title}",description:"{description}",subtitle:"{subtitle}"})}});let t=new sap.ui.model.json.JSONModel;t.setData(this.aMessages);e.setModel(t);this.oMsgDialog.destroyContent();this.oMsg+
Dialog.addContent(e);this.oMsgDialog.open()},onInit:function(e){if(sap.ui.getCore().byId("idMsg"))sap.ui.getCore().byId("idMsg").destroy();if(!this._sIdPrefix){this._sIdPrefix="br.com.trescoracoes.aprovctaspagar::sap.suite.ui.generic.template.ListReport.+
view.ListReport::ContasPagar--"}this.byId(this._sIdPrefix+"analyticalTable").getParent().setIgnoreFromPersonalisation("CompanyCodeName, SupplierFullName, CashPlanningGroupName, RepTypeText, encerradorcrit, aprov1crit, aprov2crit, aprov3crit,"+"encerrador+
text, aprov1text, aprov2text, aprov3text, Username, Userlevel, NivelAtual");this.oMsgDialog=new sap.m.Dialog({resizable:true,id:"idMsg",type:"Message",icon:"sap-icon://alert",title:this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("Me+
ssageViewTitle"),state:"Information",contentHeight:"50%",contentWidth:"50%",verticalScrolling:false,beginButton:new sap.m.Button({press:function(){this.aMessages=[];sap.ui.getCore().byId("idMsg").close()}.bind(this),text:"Close"})})},onAfterRendering:fun+
ction(e){let t=this.byId(this._sIdPrefix+"analyticalTable");for(let e of t.getColumns()){if(e.getId().split("-").pop()=="RunHourTo")e.setVisible(false)}t.attachBusyStateChanged(this._onBusyStateChanged);t.getPlugins()[0].attachSelectionChange(this._onRow+
SelectionChanged,this)},_onRowSelectionChanged:function(e){if(this.templateBaseExtension.getExtensionAPI().getSelectedContexts().length==0)this.byId("btnAprovButton").setEnabled(false);for(let e of this.templateBaseExtension.getExtensionAPI().getSelected+
Contexts())if(e.getObject().Userlevel!=e.getObject().NivelAtual){this.byId("btnAprovButton").setEnabled(false);return}else{this.byId("btnAprovButton").setEnabled(true)}},_onBusyStateChanged:function(e){let t=e.getParameter("busy");if(!t&&!this._bColumnOp+
timizationDone){let t=e.getSource();let n=null;if(sap.ui.table.TablePointerExtension){n=new sap.ui.table.TablePointerExtension(t)}else{n=new sap.ui.table.extensions.Pointer(t)}let o=t.getColumns();for(let e=0;e<o.length;e++){if(o[e].getId().split("-").po+
p()=="RunHourTo")o[e].setVisible(false)}}},onNavigate:function(e){let t=this.templateBaseExtension.getExtensionAPI();let n=e.getSource();this.getView().setBusy(true);for(let e of t.getSelectedContexts()){this.getView().getModel().read("/URL(CompanyCode='+
"+encodeURIComponent(e.getObject().CompanyCode)+"',NetDueDate=datetime'"+encodeURIComponent(new Date(e.getObject().NetDueDate).toISOString().split(".")[0])+"',CashPlanningGroup='"+encodeURIComponent(e.getObject().CashPlanningGroup)+"',RepType='"+encodeUR+
IComponent(e.getObject().RepType)+"',Tipo='0',hbkid='',rzawe='',PaymentRunID='"+encodeURIComponent(e.getObject().PaymentRunID)+"')",{success:function(e,t){switch(n.getId().split("-").pop()){case"btnPaidButton":if(e.PaymentDocument=="")sap.m.MessageBox.in+
formation(this.getOwnerComponent().getModel("i18n").getResourceBundle().getText("PaymentError"));else sap.m.URLHelper.redirect(e.PaymentDocument,true);window.location.reload();break;case"btnOpenButton":if(e.OpenDocument=="")sap.m.MessageBox.information(t+
his.getOwnerComponent().getModel("i18n").getResourceBundle().getText("OpenError"));else sap.m.URLHelper.redirect(e.OpenDocument,true);window.location.reload();break;case"btnBlockedButton":if(e.BlockedDocument=="")sap.m.MessageBox.information(this.getOwne+
rComponent().getModel("i18n").getResourceBundle().getText("BlockError"));else sap.m.URLHelper.redirect(e.BlockedDocument,true);window.location.reload();break;default:break}}.bind(this),error:function(e){sap.m.MessageBox.error(e.response);wait(4e3);window+
.location.reload()}.bind(this)})}}}});                                                                                                                                                                                                                         