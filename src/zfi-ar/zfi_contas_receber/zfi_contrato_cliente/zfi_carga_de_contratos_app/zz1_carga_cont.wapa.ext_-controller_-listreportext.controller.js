sap.ui.define(["sap/ui/export/Spreadsheet","sap/ui/export/library","sap/m/VBox","sap/m/RadioButtonGroup","sap/m/RadioButton","sap/m/Label","sap/ui/core/util/File"],function(e,t,a,s,o,r,n){"use strict";return sap.ui.controller("br.com.trescoracoes.cargade+
contratos.ext.controller.ListReportExt",{GetRadioButtonGroup:function(){this.RadioButtonGroup=new a({items:[new r({labelFor:"Carregar-Tabela",text:"Selecione qual Tabela vai ser atualizada:"}),this.oRadionGroup=new s("Carregar-Tabela",{selectedIndex:0,bu+
ttons:[new o({text:"1 - Contratos / ZTFI_CONTRATO"}),new o({text:"2 - CNPJ Principal dos Contratos / ZTFI_RAIZ_CNPJ"}),new o({text:"3 - Clientes da Raiz CNPJ Principal / ZTFI_CNPJ_CLIENT"}),new o({text:"4 - Condições de Desconto / ZTFI_CAD_COND"}),new o(+
{text:"5 - Condição de Contratos / ZTFI_CONT_COND"}),new o({text:"6 - Cadastro de Provisões / ZTFI_CAD_PROVI"}),new o({text:"7 - Cadastro Campo Familia Provisões / ZTFI_PROV_FAM"}),new o({text:"8 - Cadastro Janela Contratos / ZTFI_CONT_JANELA"}),new o({t+
ext:"9 - Níveis de Aprovação / ZTFI_CAD_NIVEL"}),new o({text:"10 - Aprovadores de Contrato Níveis / ZTFI_CAD_APROVAD"}),new o({text:"11 - Aprovações do Contrato / ZTFI_CONT_APROV"}),new o({text:"12 - Centro de Custos / ZTFI_CAD_CC"}),new o({text:"13 - Co+
ntratos Contabilizados / ZTFI_CONT_CONT"}),new o({text:"14 - Cadastro Crescimento / ZTFI_CAD_CRESCI"}),new o({text:"15 - Cadastro Faixa Bônus Crescimento / ZTFI_FAIXA_CRESC"}),new o({text:"16 - Cadastro Base de Comparação Crescimento / ZTFI_COMP_CRESCI"}+
),new o({text:"17 - Cadastro Familia Crescimento / ZTFI_CRESC_FAMIL"})]})]});this.RadioButtonGroup.addStyleClass("sapUiMediumMarginTop");return this.RadioButtonGroup},onActionUploadFile:function(e){var t=this;var a=new sap.m.Dialog({contentWidth:"600px",+
resizable:true,type:"Message"});a.setTitle("Carregar arquivo Excel");var s="/sap/opu/odata/sap/ZFI_CARGA_CONTRATOS_SRV/";var o=new sap.ui.model.odata.ODataModel(s,false);var r=s+"uploadSet";var n=new sap.ui.unified.FileUploader({width:"100%",fileType:["x+
lsx","xls"],typeMissmatch:this.handleTypeMissmatch});n.setName("Simple Uploader");n.setUploadUrl(r);n.setSendXHR(true);n.setUseMultipart(false);n.setUploadOnChange(false);var i=new sap.ui.unified.FileUploaderParameter({name:"x-csrf-token",value:o.getSecu+
rityToken()});n.insertHeaderParameter(i);var u=new sap.m.Button({text:"Upload",type:"Accept",press:function(){var e=n.getFocusDomRef();var s=e.files[0];if(n.getValue()===""){sap.m.MessageToast.show("Favor selecionar um arquivo");return}var o=new sap.ui.u+
nified.FileUploaderParameter({name:"Content-Type",value:s.type});n.insertHeaderParameter(o);var r=this.oRadionGroup.getSelectedButton().mProperties.text;n.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:n.getValue()+";"++
encodeURI(r)}));var i=function(e){return new Promise(function(e,s){n.attachUploadComplete(function(o){a.close();a.destroy();if(o.mParameters.status=="200"||o.mParameters.status=="201"||o.mParameters.status=="204"){e()}else{t.showLog(o.mParameters.respons+
eRaw);s()}t.templateBaseExtension.getExtensionAPI().refreshTable();debugger}.bind(this));n.upload()}.bind(this))}.bind(this);var u={sActionLabel:"Upload de Arquivo",dataloss:false};this.extensionAPI.securedExecution(i,u)}.bind(this)});var p=new sap.m.But+
ton({text:"Cancelar",type:"Reject",press:function(){a.close();a.destroy();this.getView().removeAllDependents()}.bind(this)});a.addContent(n);a.addContent(this.GetRadioButtonGroup());a.setBeginButton(p);a.setEndButton(u);a.open()},handleTypeMissmatch:func+
tion(e){var t=e.getSource().getFileType();jQuery.each(t,function(e,a){t[e]="*."+a});var a=t.join(", ");sap.m.MessageToast.show("Tipo de arquivo *."+e.getParameter("fileType")+" não é suportado. Escolha um dos tipos a seguir: "+a)},showLog:function(e){let+
 t=[];for(const a of e.matchAll(/(?:<message>(.*?)<[/]message>)/gm)){t.push(a[1])}let a=[];for(const t of e.matchAll(/(?:<severity>(.*?)<[/]severity>)/gm)){switch(t[1]){case"error":a.push(sap.ui.core.MessageType.Error);break;case"info":a.push(sap.ui.core+
.MessageType.Information);break;case"success":a.push(sap.ui.core.MessageType.Success);break;case"warning":a.push(sap.ui.core.MessageType.Warning);break;default:a.push(sap.ui.core.MessageType.None);break}}for(let e=0;e<t.length;e++){if(t[e]=="Ocorreu uma +
exceção"){continue}sap.ui.getCore().getMessageManager().addMessages(new sap.ui.core.message.Message({message:t[e],persistent:true,type:a[e]}))}}})});                                                                                                          