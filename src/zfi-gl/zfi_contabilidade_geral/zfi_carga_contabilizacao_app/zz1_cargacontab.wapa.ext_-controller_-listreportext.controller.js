sap.ui.define(["sap/ui/export/Spreadsheet","sap/ui/export/library"],function(e,a){"use strict";return sap.ui.controller("br.com.trescoracoes.cargacontab.ext.controller.ListReportExt",{onActionUploadFile:function(e){var a=new sap.m.Dialog({contentWidth:"3+
00px",resizable:true,type:"Message"});a.setTitle("Carregar arquivo Excel");var s="/sap/opu/odata/SAP/ZFI_CARGA_CONTAB_SRV/";var t=new sap.ui.model.odata.ODataModel(s,false);var r=s+"uploadSet";var o=new sap.ui.unified.FileUploader({width:"100%",fileType:+
["xlsx","xls"],typeMissmatch:this.handleTypeMissmatch,uploadComplete:function(e){var s=this.oView.sId+"--responsiveTable";var t=this.byId(s);t.getModel().refresh(true);a.close();a.destroy();if(e.mParameters.status=="200"||e.mParameters.status=="201"){sap+
.m.MessageToast.show("Carga realizada com sucesso.")}else{if(e.mParameters.response){if(e.mParameters.responseRaw.search("<message>")){var r=e.mParameters.responseRaw.split("<message>")[1].split("</message>")[0];alert(r)}else{alert("Return Code: "+e.mPar+
ameters.response,"Response","Response")}}}}.bind(this)});o.setName("Simple Uploader");o.setUploadUrl(r);o.setSendXHR(true);o.setUseMultipart(false);o.setUploadOnChange(false);var i=new sap.ui.unified.FileUploaderParameter({name:"x-csrf-token",value:t.get+
SecurityToken()});o.insertHeaderParameter(i);var n=new sap.m.Button({text:"Upload",type:"Accept",press:function(){var e=o.getFocusDomRef();var a=e.files[0];if(o.getValue()===""){sap.m.MessageToast.show("Favor selecionar um arquivo");return}var s=new sap.+
ui.unified.FileUploaderParameter({name:"Content-Type",value:a.type});o.insertHeaderParameter(s);o.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:o.getValue()}));o.upload()}.bind(this)});var p=new sap.m.Button({text:"Can+
celar",type:"Reject",press:function(){a.close();a.destroy();this.getView().removeAllDependents()}.bind(this)});a.addContent(o);a.setBeginButton(p);a.setEndButton(n);a.open()},handleTypeMissmatch:function(e){var a=e.getSource().getFileType();jQuery.each(a+
,function(e,s){a[e]="*."+s});var s=a.join(", ");sap.m.MessageToast.show("Tipo de arquivo *."+e.getParameter("fileType")+" não é suportado. Escolha um dos tipos a seguir: "+s)}})});                                                                           